(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(8267)}])},8267:function(e,t,r){"use strict";r.r(t),r.d(t,{__N_SSG:function(){return $},default:function(){return ee}});var n=r(1799),i=r(5893),a=r(7294),s=r(9008),l=r.n(s),o=r(828),c=r(9815),d=r(4184),u=r.n(d),h=r(9327),v={A:"#76bee6","113B":"#609a3d","101D":"#37814d","101E":"#51287f","113G":"#eab642","101H":"#3872b9","109L":"#f5d040","117N":"#9431af","107R":"#c4d53f","120W":"#479aa8",bus:"#666",C:"black",F:"black"},p=r(7757),f=r.n(p),m=r(7863),b=r.n(m),_=3600,x=function(e){var t=Math.floor(e/_),r=t>=12&&t<24;return"".concat(t>12?t-12:0===t?12:t," ").concat(r?"PM":"AM")},g=r(794),j=r.n(g),C=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:24,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=[],a=t;a<r;a++)(a-n)%e===0&&i.push(x(a*_));return i}(1),L=function(e){var t=e.color,r=e.baselineTph,n=e.currentTph,s=e.highestTph,l=(0,a.useRef)(null);return(0,a.useEffect)((function(){var e=l.current.getContext("2d"),i=b()(t).alpha(.4).rgbString(),a=[{label:"Pre-COVID trips per hour",data:r,steppedLine:!0,borderColor:t,borderWidth:2,backgroundColor:"rgba(0,0,0,0)"},{label:"Current trips per hour",data:n,steppedLine:!0,borderWidth:2,borderColor:"rgba(0,0,0,0)",backgroundColor:i}],o=new(f())(e,{type:"line",data:{labels:C,datasets:a},options:{maintainAspectRatio:!1,animation:{duration:0},legend:{position:"top",align:"end",labels:{boxWidth:15}},scales:{xAxes:[{gridLines:{display:!1},ticks:{maxTicksLimit:12}}],yAxes:[{gridLines:{display:!1},ticks:{maxTicksLimit:4,suggestedMax:s}}]},tooltips:{mode:"index",intersect:!1,callbacks:{label:function(e){var t=e.datasetIndex,r=e.index,n=a[t],i=n.label,s=n.data;return"".concat(i,": ").concat(s[r]," (each direction)")}}},elements:{line:{tension:0},point:{radius:0}}}});return function(){return o.destroy()}}),[r,n]),(0,i.jsx)("div",{className:j().tphChartContainer,children:(0,i.jsx)("canvas",{ref:l})})},y=r(2744),k=r.n(y),w=r(3316),T=r.n(w),N=new Intl.DateTimeFormat("en-US"),S=function(e){return Math.round(100*e).toString()+"%"},D=T()((function(e){var t=Date.now(),r=[],n=[],i=e.valueOf();do{r.push(N.format(i)),n.push(i),i+=864e5}while(i<=t);return{timestamps:n,dateStrings:r}}),{serializer:function(e){return e.valueOf().toString()}}),R=function(e){var t,r=e.color,n=e.serviceHistory,s=e.startDate,l=e.lineTitle,o=e.lineId,d=e.rtd_ridership,u=(0,a.useRef)(null),h=d[l.split(",")[0].trim()];void 0!==h&&(t=h.reduce((function(e,t){return e.riders>t.riders?e:t})).riders,h=h.map((function(e){return{x:e.date,y:e.riders?e.riders/t:"NaN"}})));var v=(0,a.useMemo)((function(){return n&&function(e){var t,r=(t=Math).max.apply(t,(0,c.Z)(e));return e.map((function(e){return Math.round(e/r*10)/10}))}(n)}),[n]),p=(0,a.useMemo)((function(){return D(s)}),[s]).timestamps;return(0,a.useEffect)((function(){var e=b()(r).alpha(.8).rgbString(),t=u.current.getContext("2d"),i=[h&&{label:"Ridership",actual:h.map((function(e){return e.riders})),unit:"monthly riders",data:h,borderColor:r,backgroundColor:e,borderWidth:2,spanGaps:!1},{label:"Service levels",actual:n,unit:"weekday trips per direction",data:v,borderColor:e,backgroundColor:k().draw("diagonal","rgba(0,0,0,0)",r,5),borderWidth:2}].filter((function(e){return e})),a=new(f())(t,{type:"line",data:{datasets:i,labels:p},options:{maintainAspectRatio:!1,animation:{duration:0},scales:{xAxes:[{gridLines:{display:!1},type:"time",ticks:{min:"2019-10-15"},time:{unit:"month",displayFormats:{month:"MMM 'YY"}}}],yAxes:[{ticks:{beginAtZero:!0,stepSize:.2,maxTicksLimit:6,callback:S},gridLines:{display:!1}}]},elements:{point:{radius:0},line:{tension:0}},legend:{position:"top",align:"end",labels:{boxWidth:15}},tooltips:{mode:"index",intersect:!1}}});return function(){return a.destroy()}}),[h,v,o]),(0,i.jsx)("div",{className:j().serviceAndRidershipChartContainer,children:(0,i.jsx)("canvas",{className:j().serviceAndRidershipChart,ref:u})})},E=[{value:"weekday",label:"Weekdays"},{value:"saturday",label:"Saturday"},{value:"sunday",label:"Sunday"}],M=function(e){var t=e.lineData,r=e.rtd_ridership,n=t.id,s=t.lineKind,l=t.serviceHistory,d=t.serviceRegimes,p=t.startDate,f=t.shortName,m=t.longName,b=v[s]||"black",_=(0,a.useState)("weekday"),x=_[0],g=_[1],C=(0,a.useMemo)((function(){return function(e){var t=0;return Object.entries(e.serviceRegimes).forEach((function(e){var r=(0,o.Z)(e,2),n=r[0],i=r[1];"baseline"!==n&&"current"!==n||Object.values(i).forEach((function(e){var r;e.tripsPerHour&&(t=(r=Math).max.apply(r,[t].concat((0,c.Z)(e.tripsPerHour))))}))})),t}(t)}),[t]),y=(0,a.useMemo)((function(){return new Date(p)}),[p]),k=f||m,w=r[f]?"Service and ridership over time":"Service over time (ridership not available)",T=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(0,i.jsxs)("h3",{className:j().sectionLabel,children:[(0,i.jsx)("div",{className:"label",children:e}),t]})},N=(0,i.jsx)(J,{className:j().tabs,value:x,items:E,onSelectValue:function(e){return g(e)},baseId:"line-day-selector-".concat(n),"aria-label":"Select day of service"}),S="bus"!==s?"".concat(k," Line"):k;return(0,i.jsxs)(Q,{title:S,topRight:function(){var e=d.current,t=d.baseline;return 0===e.weekday.totalTrips?(0,i.jsxs)("div",{className:u()(j().statusBadge,"bad"),children:[(0,i.jsx)(h.KZq,{size:20}),"Canceled"]}):0===e.saturday.totalTrips&&t.saturday.totalTrips>0?(0,i.jsxs)("div",{className:u()(j().statusBadge,"warning"),children:[(0,i.jsx)(h.KZq,{size:20}),"Weekends"]}):void 0}(),details:null,children:[T("Service per hour",N),(0,i.jsx)(L,{lineTitle:"".concat(k,", ").concat(x),baselineTph:d.baseline[x].tripsPerHour,currentTph:d.current[x].tripsPerHour,color:b,highestTph:C}),T(w),(0,i.jsx)(R,{lineId:t.id,lineTitle:"".concat(k,", ").concat(x),startDate:y,serviceHistory:l,color:b,rtd_ridership:r})]})},F=r(5675),G=r.n(F),A=["A","113B","C","101D","101E","F","113G","101H","109L","117N","107R","120W"],I={kind:function(e){var t=A.indexOf(e.lineKind);if(-1!==t)return t;var r=300+parseInt(e.routeId);return Number.isNaN(r)?1/0:r},lowestServiceFraction:function(e){return e.serviceFraction},highestServiceFraction:function(e){return-e.serviceFraction},lowestTotalTrips:function(e){return e.totalTrips},highestTotalTrips:function(e){return-e.totalTrips}},H=r(1945),O=r.n(H),Z=function(e){return!!e},B=function(e){var t=e.lineData,r=e.summaryData,n=e.rtd_ridership,s=e.filter,l=void 0===s?Z:s,o=(0,a.useState)(12),c=o[0],d=o[1],h=(0,a.useState)(""),v=h[0],p=h[1],f=(0,a.useState)(""),m=f[0],b=f[1],_=(0,a.useState)("grid"),x=_[0],g=_[1],j=(0,a.useState)("all"),C=j[0],L=j[1],y=(0,a.useMemo)((function(){return function(e,t){var r={};return e.forEach((function(e){r[e.id]=t(e)})),e.sort((function(e,t){var n=r[e.id],i=r[t.id];return n===i?0:n>i?1:-1}))}(Object.values(t).filter((function(e){return l(e)&&function(e,t){var r=e.id,n=e.shortName||e.longName;return!t||(null===n||void 0===n?void 0:n.toLowerCase().includes(t))||r.toLowerCase().includes(t)}(e,v)&&function(e,t){var r=e.lineKind;return"all"===t||("bus"===t?r===t:"rail"===t&&"bus"!==r)}(e,C)})),I[m||"kind"])}),[t,l,v,C,m]),k=(0,a.useMemo)((function(){return y.slice(0,c)}),[y,c]);!function(e){var t=e.element,r=e.enabled,n=e.onRequestMoreItems,i=e.scrollTolerance,s=void 0===i?0:i;(0,a.useEffect)((function(){if(t&&r&&n){var e=function(){t&&r&&function(e,t){return e.scrollHeight-e.scrollTop-t<=e.clientHeight}(t,s)&&n()};e();var i=t===document.documentElement?window:t;return i.addEventListener("scroll",e),function(){return i.removeEventListener("scroll",e)}}return function(){}}),[t,r,s,n])}({element:"undefined"!==typeof document?document.documentElement:null,enabled:c<y.length,scrollTolerance:300,onRequestMoreItems:function(){return d((function(e){return e+12}))}});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:O().header,children:[(0,i.jsx)("a",{href:"https://www.greaterdenvertransit.com/",children:(0,i.jsx)(G(),{src:"/gdt.png",className:O().logo,height:80,width:144,alt:"Greater Denver Transit logo"})}),(0,i.jsx)("h1",{children:"RTD Service & Ridership Tracker"})]}),(0,i.jsxs)("div",{className:O().controls,children:[(0,i.jsx)("input",{placeholder:"Filter lines",className:O().filter,value:v,onChange:function(e){p(e.target.value.toLowerCase().trim()),d(12)}}),(0,i.jsxs)("select",{value:x,className:u()(O().select,O().displaySelect),onChange:function(e){return g(e.target.value)},children:[(0,i.jsx)("option",{value:"grid",children:"Show grid"}),(0,i.jsx)("option",{value:"rows",children:"Show rows"})]}),(0,i.jsxs)("select",{className:O().select,value:C,onChange:function(e){var t=e.target.value;L(t),d(12)},children:[(0,i.jsx)("option",{value:"all",children:"All lines"}),(0,i.jsx)("option",{value:"bus",children:"Bus"}),(0,i.jsx)("option",{value:"rail",children:"Rail"})]}),(0,i.jsxs)("select",{className:u()(O().select,"kind"===m&&"default"),value:m,onChange:function(e){b(e.target.value),d(12)},children:[(0,i.jsx)("option",{value:"",disabled:!0,children:"Sort by..."}),(0,i.jsx)("option",{value:"kind",children:"Service kind"}),(0,i.jsx)("option",{value:"highestServiceFraction",children:"Least service cut"}),(0,i.jsx)("option",{value:"lowestServiceFraction",children:"Most service cut"}),(0,i.jsx)("option",{value:"lowestTotalTrips",children:"Least service"}),(0,i.jsx)("option",{value:"highestTotalTrips",children:"Most service"})]}),(0,i.jsxs)("div",{className:O().links,children:[(0,i.jsxs)("span",{children:["Data through ",r.endDate]}),(0,i.jsx)("a",{href:"https://www.greaterdenvertransit.com/",children:"Greater Denver Transit"}),(0,i.jsx)("a",{href:"https://github.com/GreaterDenverTransit/rtd-dash",children:"Source code"}),(0,i.jsx)("a",{href:"mailto:greaterdenvertransit@gmail.com?subject=Dashboard Feedback",children:"Send feedback"})]})]}),(0,i.jsx)("div",{className:u()(O().lineGrid,x),children:k.map((function(e){return(0,i.jsx)(M,{lineData:e,rtd_ridership:n},e.id)}))})]})},P=r(9396),W=r(7775),q=r(8968),K=r(8132),Y=r(8514),V=r.n(Y),z=function(e,t){return"".concat(e,"-").concat(t)},J=function(e){var t=e["aria-label"],r=e.baseId,s=e.className,l=e.items,o=e.onSelectValue,c=e.style,d=void 0===c?{}:c,h=e.tabClassName,v=e.value,p=(0,W.x)({selectedId:z(r,v)});return(0,a.useEffect)((function(){var e=document.querySelector("#".concat(p.selectedId));e&&o(e.getAttribute("data-value"))}),[p.selectedId]),(0,i.jsx)(q.t,(0,P.Z)((0,n.Z)({},p),{style:d,className:u()(V().tabList,s),"aria-label":t,as:"div",children:l.map((function(e){var t=e.value,s=e.label;return(0,a.createElement)(K.O,(0,P.Z)((0,n.Z)({},p),{id:z(r,t),className:u()(V().tab,h),key:t,as:"div","data-value":t}),(0,i.jsx)("span",{children:s}))}))}))},X=r(2672),U=r.n(X),Q=function(e){var t=e.title,r=e.topRight,n=void 0===r?null:r,a=e.details,s=void 0===a?null:a,l=e.children,o=e.className;return(0,i.jsxs)("div",{className:u()(U().cardFrame,o),children:[(0,i.jsxs)("div",{className:U().topRow,children:[(0,i.jsx)("h2",{className:U().title,children:t}),n]}),s?(0,i.jsx)("div",{className:U().details,children:s}):null,l]})},$=!0,ee=function(e){var t=e.data;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(l(),{children:[(0,i.jsx)("title",{children:"RTD Service Dashboard"}),(0,i.jsx)("meta",{name:"author",content:"Greater Denver Transit"}),(0,i.jsx)("meta",{name:"description",content:"Data on RTD ridership and service levels"}),(0,i.jsx)("link",{rel:"icon",type:"image/png",href:"./favicon.png"})]}),(0,i.jsx)(B,(0,n.Z)({rtd_ridership:void 0},t))]})}},2672:function(e){e.exports={cardFrame:"CardFrame_cardFrame__Zylu8",topRow:"CardFrame_topRow__TEYCk",title:"CardFrame_title__hLgKe",details:"CardFrame_details__au75q"}},794:function(e){e.exports={cancellationText:"LineCard_cancellationText__tHpkh",cancellationIcon:"LineCard_cancellationIcon__rhK5O",statusBadge:"LineCard_statusBadge__ElYYD",tphChartContainer:"LineCard_tphChartContainer__oBkRt",tphChartLabel:"LineCard_tphChartLabel__pWMKY",sectionLabel:"LineCard_sectionLabel__fw1a3",serviceAndRidershipChartContainer:"LineCard_serviceAndRidershipChartContainer__mDREe",tabs:"LineCard_tabs__38bYV",detailsExpanded:"LineCard_detailsExpanded__o2X0B"}},1945:function(e){e.exports={lineGrid:"LineGrid_lineGrid__KOGvB",header:"LineGrid_header__13uwj",links:"LineGrid_links__qGPSx",controls:"LineGrid_controls__pHLJc",filter:"LineGrid_filter__tH_J9",select:"LineGrid_select__AJIqq",default:"LineGrid_default__JOHcw",displaySelect:"LineGrid_displaySelect__qLU0v"}},8514:function(e){e.exports={tabList:"TabPicker_tabList__yBmnA",tab:"TabPicker_tab__Vahr6"}}},function(e){e.O(0,[90,885,698,170,774,888,179],(function(){return t=8312,e(e.s=t);var t}));var t=e.O();_N_E=t}]);